{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*",
  "apiURL": "https://localhost:44396/",
  "NLog": {
    "autoReload": true,
    "throwConfigExceptions": true,
    "internalLogLevel": "Info",
    "internalLogFile": "C:\\temp\\internal-nlog-AspNetCore.txt",
    "extensions": [
      {
        "assembly": "NLog.Web.AspNetCore"
      },
      {
        "assembly": "NLog.Database"
      }
    ],
    "variables": {
      "basedir": "C:\\temp\\"
    },
    "targets": {
      "async": true,
      "db": {
        "type": "Database",
        "commandText": "insert into [dbo].[Log] ([OperationId], [Layer], [User], [Action], [Level], [Message], [TimeStamp], [Version]) values (@OperationId, 0, @User, @Action, @Level, @Message, @TimeStamp, @Version)",
        "connectionString": "${configsetting:item=ConnectionStrings.Discography}", // legge la propriet√† di cui sopra
        "parameters": [
          {
            "name": "@OperationId",
            "layout": "${scopeproperty:OperationId}",
            "dbType": "DbType.Guid",
            "allowDbNull": "true"
          },
          {
            "name": "@User",
            "layout": "${scopeproperty:User}"
          },
          {
            "name": "@Action",
            "layout": "${scopeproperty:item=Action}",
            "AllowDbNull": "true"
          },
          {
            "name": "@Level",
            "layout": "${level:format=Ordinal}"
          },
          {
            "name": "@Message",
            "layout": "${message}"
          },
          {
            "name": "@TimeStamp",
            "layout": "${date}"
          },
          {
            "name": "@Version",
            "layout": "${scopeproperty:Version}"
          }
        ]
      },
      "fileLog": {
        "type": "File",
        "fileName": "${basedir}logfile.txt",
        "layout": "${longdate} ${logger} ${message} ${exception:format=ToString}",
        "keepFileOpen": true,
        "encoding": "utf-8"
      }
    },
    "rules": [
      {
        "logger": "Program",
        "minLevel": "Debug",
        "writeTo": "fileLog",
        "final": true
      },
      {
        "logger": "*",
        "minLevel": "Info",
        "writeTo": "db",
        "filterDefaultAction": "Log",
        "filters": [
          {
            "type": "when",
            "condition": "length('${scopeproperty:User}') == 0",
            "action": "Ignore"
          }
        ]
      }
    ]
  }
}
